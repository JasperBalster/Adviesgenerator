<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Advies Generator met Hugging Face</title>
</head>
<body>
  <h2>Advies Generator</h2>

  <!-- Input velden -->
  Naam: <input type="text" id="naam" /><br/>
  Onderzoekstype:
  <select id="onderzoekstype">
    <option>PMO</option>
    <option>Healthcheck</option>
    <option>Sportkeuring</option>
  </select><br/>
  Bedrijf: <input type="text" id="bedrijf" /><br/>
  Werkvermogen:
  <select id="werkvermogen">
    <option>Slecht</option>
    <option>Matig</option>
    <option>Goed</option>
  </select><br/>
  Werkgerelateerd feedback:<br/>
  <textarea id="werkfeedback" rows="3" cols="40"></textarea><br/>
  Leefstijl feedback:<br/>
  <textarea id="leefstijlfeedback" rows="3" cols="40"></textarea><br/>
  Biometrie feedback:<br/>
  <textarea id="biometrie" rows="3" cols="40"></textarea><br/>
  Gezondheidsmetingen:<br/>
  <textarea id="gezondheid" rows="3" cols="40"></textarea><br/>
  Ogen en oren:<br/>
  <textarea id="ogenoren" rows="3" cols="40"></textarea><br/>
  Longfunctie:<br/>
  <textarea id="longfunctie" rows="3" cols="40"></textarea><br/>
  Fysieke metingen:<br/>
  <textarea id="fysieke" rows="3" cols="40"></textarea><br/>
  Extra advies:<br/>
  <textarea id="extra" rows="3" cols="40"></textarea><br/>
  Contactgegevens:<br/>
  <textarea id="contact" rows="2" cols="40"></textarea><br/>

  <button id="genereer">Genereer Advies</button>

  <h3>Advies Output:</h3>
  <textarea id="output" rows="15" cols="80" readonly></textarea>

  <script>
    const apiToken = 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;

    async function genereerAdvies() {
      const naam = document.getElementById('naam').value;
      const type = document.getElementById('onderzoekstype').value;
      const bedrijf = document.getElementById('bedrijf').value;
      const werkvermogen = document.getElementById('werkvermogen').value;
      const werkfeedback = document.getElementById('werkfeedback').value;
      const leefstijlfeedback = document.getElementById('leefstijlfeedback').value;
      const biometrie = document.getElementById('biometrie').value;
      const gezondheid = document.getElementById('gezondheid').value;
      const ogenoren = document.getElementById('ogenoren').value;
      const longfunctie = document.getElementById('longfunctie').value;
      const fysieke = document.getElementById('fysieke').value;
      const extra = document.getElementById('extra').value;
      const contact = document.getElementById('contact').value;

      // Prompt samenstellen
      const prompt = `
Beste ${naam},

Bedankt voor de deelname aan de ${type} via ${bedrijf}. Je scoort een ${werkvermogen} werkvermogen, dat betekent dat ...

Werkgerelateerd:
${werkfeedback}

Leefstijl:
${leefstijlfeedback}

Biometrie:
${biometrie}

Gezondheidsmetingen:
${gezondheid}

Ogen en oren:
${ogenoren}

Longfunctie:
${longfunctie}

Fysieke metingen:
${fysieke}

Extra advies:
${extra}

Wij wijzen erop dat het ${type} een momentopname is. Bij klachten over uw gezondheid of inzetbaarheid dient u met uw huisarts of bedrijfsarts contact op te nemen. Mocht u over de uitslagen nog vragen hebben, dan kunt u met ondergetekende contact opnemen.

Met vriendelijke groet,
${contact}
      `;

      // API call naar Hugging Face
      const response = await fetch("https://api-inference.huggingface.co/models/gpt2", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${apiToken}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          inputs: prompt,
          options: { wait_for_model: true }
        })
      });

      if (!response.ok) {
        document.getElementById('output').value = `Fout bij het ophalen van advies: ${response.status} ${response.statusText}`;
        return;
      }

      const data = await response.json();

      if(data.error) {
        document.getElementById('output').value = `API fout: ${data.error}`;
        return;
      }

      // Data is een array met tekstresultaten
      const adviesTekst = data[0].generated_text || "Geen advies ontvangen.";
      document.getElementById('output').value = adviesTekst;
    }

    document.getElementById('genereer').addEventListener('click', () => {
      document.getElementById('output').value = "Bezig met genereren...";
      genereerAdvies();
    });
  </script>
</body>
</html>
